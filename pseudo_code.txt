# pseudo code for processing packet

if arrival event:
  if handshake arrival event:
    process handshake arrival event

  else if data packet arrival event:
    process data packet arrival event

  else if ack packet arrival event
    process ack packet arrival event

else if departure event:
  if data packet event:
    process data packet departure

  else if ack packet event:
    process ack packet departure

else if channel-sensing event:
  if channel is free:

  else if channel is not free:

else if timeout event:
  

else:
  throw error

gel.pop()
previous_time = global_time



